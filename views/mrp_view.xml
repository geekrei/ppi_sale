<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <record id="mrp_production_form_view_extend" model="ir.ui.view">
            <field name="name">mrp.production.form.extend</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_form_view" />
            <field name="arch" type="xml">

                <!-- <xpath expr="//header" position="inside">
                    <button name="action_approve" type="object" string="Approve" class="oe_highlight" state="confirmed"/>
                </xpath> -->

                <xpath expr="//header" position="replace">
                    <header>
                        <field name="consumed_less_than_planned" invisible="1"/>
                        <button name="action_approve" type="object" string="Approve" class="oe_highlight" states="confirmed"/>
                        <button name="button_mark_done" attrs="{'invisible': ['|', ('check_to_done', '=', False), ('consumed_less_than_planned', '=', True)]}" string="Mark as Done" type="object" class="oe_highlight"/>
                        <button name="button_mark_done" attrs="{'invisible': ['|', ('check_to_done', '=', False), ('consumed_less_than_planned', '=', False)]}" string="Mark as Done" type="object" class="oe_highlight" confirm="You have consumed less material than what was planned. Are you sure you want to close this MO?"/>
                        <button name="action_assign" attrs="{'invisible': ['|', ('availability', 'in', ('assigned', 'none')), ('is_locked', '=', False)]}" string="Check availability" type="object" class="oe_highlight"/>
                        <button name="button_plan" attrs="{'invisible': ['|', '|', ('state', '!=', 'approved'), ('routing_id', '=', False), ('is_locked', '=', False)]}" type="object" string="Create Workorders" class="oe_highlight"/>
                        <button name="open_produce_product" attrs="{'invisible': ['|', '|', '|', '|', ('is_locked', '=', False), ('check_to_done', '=', True), ('availability', 'not in', ['partially_available', 'assigned']), ('state', 'not in', ('approved','progress')), ('routing_id', '!=', False)]}" string="Produce" type="object" class="oe_highlight"/>
                        <button name="open_produce_product" attrs="{'invisible': ['|', '|', '|', '|', ('is_locked', '=', False), ('check_to_done', '=', True), ('availability', '!=', 'waiting'), ('state', 'not in', ('approved','progress')), ('routing_id', '!=', False)]}" string="Produce" type="object"/>
                        <button name="post_inventory" string="Post Inventory" type="object" attrs="{'invisible': [('post_visible', '=', False)]}" groups="base.group_no_one"/>
                        <button name="action_cancel" type="object" string="Cancel" attrs="{'invisible': ['|', '|', ('is_locked', '=', False), ('state', 'in', ('done','cancel')), ('check_to_done', '=', True)]}"/>
                        <button name="button_scrap" type="object" string="Scrap" attrs="{'invisible': ['|', '|', ('availability', '=', 'none'), ('state', 'in', ('cancel')), ('is_locked', '=', False)]}"/>
                        <button name="button_unreserve" type="object" string="Unreserve" attrs="{'invisible': [('unreserve_visible', '=', False)]}"/>
                        <span class="label label-danger" attrs="{'invisible': ['|',('availability', 'in', ('assigned', 'none')), ('state', 'not in', ('approved','progress'))]}">Raw materials not available!</span>
                        <field name="state" widget="statusbar" statusbar_visible="confirmed,approved,progress,done"/>
                        <button name="action_toggle_is_locked" attrs="{'invisible': ['|', '|', ('state', '=', 'cancel'), ('id', '=', False), ('is_locked', '=', False)]}" string="Unlock" groups="mrp.group_mrp_manager" type="object" help="If the manufacturing order is unlocked you can add to the initial demand."/>
                        <button name="action_toggle_is_locked" attrs="{'invisible': [('is_locked', '=', True)]}" string="Lock" class="oe_highlight" groups="mrp.group_mrp_manager" type="object"/>
                    </header>
                </xpath>

            </field>
        </record> 

        <record id="view_mrp_production_filter_extend" model="ir.ui.view">
            <field name="name">mrp.production.select.extend</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.view_mrp_production_filter" />
            <field name="arch" type="xml">
                <xpath expr="//search/filter[@name='todo']" position="attributes">
                    <attribute name="domain">[('state','in',('confirmed', 'approved', 'planned', 'progress'))]</attribute>
                </xpath>
                <xpath expr="//search/filter[@name='confirmed']" position="after">
                    <filter string="Approved" name="approved" domain="[('state','=','approved')]"/>
                </xpath>
            </field>
        </record>

    </data>
</odoo>